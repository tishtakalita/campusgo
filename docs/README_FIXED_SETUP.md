# Amrita University AIE C Section Database Setup (CORRECTED)

## Overview
Complete database replacement with Amrita University AIE C section data. This setup creates 60 students following the proper student ID format `cb.sc.u4aie23XXX` where XXX represents C section (2) + individual roll numbers (01-60).

## Fixed Files (UUID Corrected)

### 1. `amrita_fixed_uuids.sql` - Main Setup Script
- **Purpose**: Primary database setup with proper PostgreSQL UUIDs
- **Contains**:
  - 3 departments (AIE, CSE, AID)
  - 8 faculty members with Amrita email format (`a_name@cb.amrita.edu`)
  - 8 courses from AIE C section timetable
  - First 20 students (cb.sc.u4aie23201-cb.sc.u4aie23220)
  - Sample classes based on Monday timetable
  - Sample enrollments for first 2 students
  - User preferences for students

### 2. `remaining_students_fixed.sql` - Additional Students
- **Purpose**: Adds remaining 40 students to complete 60-student class
- **Contains**:
  - Students cb.sc.u4aie23221 to cb.sc.u4aie23260
  - User preferences for all new students
  - Proper UUID format throughout

### 3. `complete_enrollments_fixed.sql` - All Enrollments
- **Purpose**: Enrolls all 60 students in all 8 courses
- **Generated by**: `generate_enrollments_fixed.py`
- **Contains**: 480 enrollment records (60 students × 8 courses)

### 4. `generate_enrollments_fixed.py` - Enrollment Generator
- **Purpose**: Python script to generate enrollment SQL with proper UUIDs
- **Output**: Creates `complete_enrollments_fixed.sql`

## Student ID Format
- **Pattern**: `cb.sc.u4aie23XXX`
- **Where**: 
  - `cb.sc.u4` = Amrita University prefix
  - `aie` = Department (Artificial Intelligence and Engineering)
  - `23` = Year (2023 batch)
  - `2XX` = C section (2) + roll number (01-60)

## Email Formats
- **Students**: `cb.sc.u4aie23XXX@cb.students.amrita.edu`
- **Faculty**: `a_firstname@cb.amrita.edu`

## Execution Order

### Step 1: Main Setup
```sql
-- Run the main setup script
\i amrita_fixed_uuids.sql
```

### Step 2: Add Remaining Students
```sql
-- Add the remaining 40 students
\i remaining_students_fixed.sql
```

### Step 3: Generate Enrollments
```bash
# Generate enrollment SQL file
python generate_enrollments_fixed.py
```

### Step 4: Add All Enrollments
```sql
-- Enroll all students in all courses
\i complete_enrollments_fixed.sql
```

## Verification Queries

### Check Student Count
```sql
-- Should return 60
SELECT COUNT(*) as total_students FROM users WHERE role = 'student';
```

### Check Faculty Count
```sql
-- Should return 8
SELECT COUNT(*) as total_faculty FROM users WHERE role = 'faculty';
```

### Check Course Count
```sql
-- Should return 8
SELECT COUNT(*) as total_courses FROM courses WHERE is_active = true;
```

### Check Enrollment Count
```sql
-- Should return 480 (60 students × 8 courses)
SELECT COUNT(*) as total_enrollments FROM enrollments;
```

### Check Student ID Format
```sql
-- All should follow cb.sc.u4aie23XXX pattern
SELECT student_id FROM users WHERE role = 'student' ORDER BY student_id;
```

### Check Email Format
```sql
-- All should follow proper Amrita format
SELECT email FROM users WHERE role = 'student' ORDER BY email;
```

### Enrollment Distribution
```sql
-- Each student should have 8 courses
SELECT student_id, COUNT(*) as course_count 
FROM enrollments e
JOIN users u ON e.student_id = u.id
GROUP BY student_id 
ORDER BY student_id;
```

### Course Enrollment
```sql
-- Each course should have 60 students
SELECT c.name, c.code, COUNT(e.id) as student_count
FROM courses c
LEFT JOIN enrollments e ON c.id = e.course_id
GROUP BY c.id, c.name, c.code
ORDER BY c.code;
```

## Course List (AIE C Section)
1. **22AIE301** - Probabilistic Reasoning (Dr. Milton Mondal)
2. **22AIE302** - Formal Language and Automata (Prof. Soman K P)  
3. **22AIE303** - Database Management Systems (Dr. Archuda)
4. **22AIE304** - Deep Learning (Dr. Prem Jagadeesan)
5. **22AIE305** - Introduction to Cloud Computing (Ms. Prajisha C)
6. **22AIE438** - Biomedical Signal Processing (Dr. Amrutha V)
7. **22AIE452** - Data Driven Material Modelling (Dr. Krithesh K Gupta)
8. **19SSK301** - Soft Skills II (Soft Skills Instructor)

## Key Features
- ✅ Proper PostgreSQL UUID format (fixed from previous version)
- ✅ 60 students with realistic Indian names
- ✅ Proper Amrita University ID format
- ✅ Correct email domains for students and faculty
- ✅ All students in 3rd year (2023 batch)
- ✅ Complete enrollment in all 8 courses
- ✅ Faculty mapped to actual courses from timetable
- ✅ Sample classes based on actual timetable
- ✅ User preferences and GPA data

## Database Statistics After Setup
- **Departments**: 3
- **Faculty**: 8
- **Courses**: 8
- **Students**: 60
- **Enrollments**: 480
- **Classes**: 7 (sample Monday classes)
- **User Preferences**: 60

## Troubleshooting

### UUID Format Errors
If you encounter "invalid input syntax for type uuid" errors, ensure you're using the fixed files:
- ❌ Old format: `aie-dept-uuid-0001-0001-0001-000000000001`
- ✅ New format: `11111111-1111-1111-1111-111111111001`

### Missing Students
If student count is less than 60:
1. Check if `remaining_students_fixed.sql` was executed
2. Verify no foreign key constraint errors occurred

### Enrollment Issues
If enrollment count is less than 480:
1. Ensure all 60 students were created first
2. Check if `complete_enrollments_fixed.sql` was executed completely
3. Verify no duplicate key errors

## Files Summary
- `amrita_fixed_uuids.sql` - Main setup (20 students + core data)
- `remaining_students_fixed.sql` - Remaining 40 students
- `generate_enrollments_fixed.py` - Enrollment generator script
- `complete_enrollments_fixed.sql` - All 480 enrollments (generated)

This setup provides a complete, realistic database for the Amrita University AIE C section with proper UUID formatting for PostgreSQL compatibility.